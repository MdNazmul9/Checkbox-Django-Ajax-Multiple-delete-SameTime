<!-- {% extends '_base.html' %} -->


{% block content %}
<h1>Hello world</h1>

<div class="container">
    <div class="card"> 

        <!-- <table> -->
            <table cellspacing="0" rules="all" border="1" id="Table1" style="border-collapse: collapse; text-align: center">
            <thead>
                <th>Product Name</th>
                <th>Catagory</th>
                <th>Price</th>
                <th>Delete</th>
    
            </thead>
            <tbody>
                {% csrf_token %}
                {% for prod in products %}
                <tr id="{{ prod.id }}">
                    <td>{{ prod.name }}</td>
                    <td>{{ prod.category }}</td>
                    <td>{{ prod.price }}</td>
                    <td><input type="checkbox" name="product_id[]" value="{{prod.id}}" id="delete_product" </td>
                </tr>             
                {% endfor %} 
               
            </tbody>
    
        </table>
       
        
    </div>
    <div>
        <button type="submit"  id="delete_btn" class="btn btn-danger mt-2">Delete</button>



    </div>

    

</div>

<!-- <script src= "https://code.jquery.com/jquery-2.2.4.min.js"></script> -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


<script type="text/javascript">
    $(document).ready(function(){
        $('#delete_btn').click(function(){
            if(confirm("Are you sure want to delete this item?")){
                var id = [];
                var csrf=$('input[name=csrfmiddlewaretoken]').val()
                // $('[name="csrfmiddlewaretoken"]').val()
                // const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
                $(':checkbox:checked').each(function(i){
                    id[i]=$(this).val();
                })
                if(id.length ===0){
                    alert("Please select items to delete.")
                }else{
                    console.log(id);
                    $.ajax({
                        url:'.',
                        method:"POST",
                        data:{
                            id,
                            // csrfmiddlewaretoken:csrftoken
                            'csrfmiddlewaretoken': csrf,
                        },
                        success:function(response){
                            for(var i=0; i<id.length;i++){
                                $('tr#'+id[i]+'').css('background-color', '#ccc');
                                $('tr#'+id[i]+'').fadeOut('show');

                            }
                        }
                    })

                
                }

            }
        }) 
    
    })

</script>



      
{% endblock content %}

{% block scripts %}
<!-- 
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->

<!-- <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> -->
<!-- <script> -->

  
{% endblock scripts %}
